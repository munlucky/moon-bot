---
name: security-reviewer
description: 보안 취약점을 검토합니다. 보안 우려가 감지되거나 중요한 변경사항 배포 전 사용하세요.
context: fork
---

# 보안 리뷰어 스킬

## 사용 시점

- 코드 리뷰 중 보안 우려 감지
- API 키 또는 자격증명 노출 의심
- 인증/권한 관련 변경사항 배포 전
- 사용자 입력 또는 외부 데이터 처리 시

## 절차

1. 변경된 파일에서 보안 패턴 스캔
2. 보안 체크리스트(`.claude/rules/security.md`) 대비 확인
3. 심각도 수준별 발견사항 보고
4. 각 이슈에 대한 수정안 제안

## 보안 체크리스트

### CRITICAL (머지 전 필수 수정)
- [ ] 하드코딩된 시크릿 (API 키, 비밀번호, 토큰)
- [ ] SQL 인젝션 취약점
- [ ] XSS 취약점 (이스케이프되지 않은 사용자 입력)
- [ ] 인증 우회 위험

### HIGH (수정 권장)
- [ ] 입력 검증 누락
- [ ] 취약한 의존성 (오래된 패키지)
- [ ] 경로 탐색 위험
- [ ] CSRF 취약점

### MEDIUM (권장)
- [ ] Rate limiting 누락
- [ ] 정보 노출하는 상세 에러 메시지
- [ ] HTTPS 강제 누락
- [ ] 약한 비밀번호 정책

## 출력 형식

```markdown
## 보안 리뷰 결과

### 요약
- 스캔 파일: N개
- Critical: N | High: N | Medium: N

### 발견사항

#### [CRITICAL] 하드코딩된 API 키
- **파일**: src/api/client.ts:42
- **이슈**: 소스코드에 API 키 노출
- **수정안**: 환경 변수로 이동

#### [HIGH] 입력 검증 누락
- **파일**: src/routes/user.ts:15
- **이슈**: 사용자 입력이 쿼리에 직접 전달
- **수정안**: Zod 검증 스키마 추가

### 판정
❌ BLOCK / ⚠️ WARNING / ✅ PASS
```

## 자동 트리거 조건

| 신호 | 동작 |
|------|------|
| `*.env` 파일 수정 | 리뷰 트리거 |
| 인증 관련 파일 변경 | 리뷰 트리거 |
| 새 의존성 추가 | 취약점 확인 |
| API 엔드포인트 추가 | 입력 처리 검증 |

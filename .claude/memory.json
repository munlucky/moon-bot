{"type":"entity","name":"moonbot::Boundary::AlwaysDo","entityType":"boundary","observations":["커밋 전 pnpm lint 실행","TypeScript 빌드 통과 확인 (pnpm build)","보안 검토 후 하드코딩된 시크릿 없는지 확인"]}
{"type":"entity","name":"moonbot::Boundary::AskFirst","entityType":"boundary","observations":["새로운 채널 어댑터 추가 시","외부 포트 바인딩 설정 변경 시","세션 저장 경로 구조 변경 시","핵심 도구(Browser, HTTP, Desktop) 승인 정책 수정 시"]}
{"type":"entity","name":"moonbot::Boundary::NeverDo","entityType":"boundary","observations":["하드코딩된 API 키/토큰 커밋",".env 파일 커밋","루프백이 아닌 외부 바인딩 시 인증 없이 노출","SSRF 보호 없이 HTTP 도구 사용"]}
{"type":"entity","name":"moonbot::Component::Gateway","entityType":"component","observations":["WebSocket 서버 (포트 18789)","JSON-RPC 프로토콜 핸들러","세션/채널/노드/훅 통합 관리","파일 위치: src/gateway/"]}
{"type":"entity","name":"moonbot::Component::Channels","entityType":"component","observations":["멀티 서피스 채널 어댑터","Discord 어댑터 구현 (discord.js)","Mention Gating (@agent 언급 시만 활성화)","DM 페어링 승인 흐름","파일 위치: src/channels/"]}
{"type":"entity","name":"moonbot::Component::Agents","entityType":"component","observations":["Planner-Executor-Replanner 모델","Planner: 목표 분해 (고성능 LLM)","Executor: 도구 호출 및 결과 수집","Replanner: 실패 시 대체 도구 선택","파일 위치: src/agents/"]}
{"type":"entity","name":"moonbot::Component::Tools","entityType":"component","observations":["TypeBox 기반 JSON Schema 계약","Browser Tool: Playwright 웹 제어","HTTP Tool: API 호출 + SSRF 가드","Filesystem Tool: 파일 I/O + 경로 검증","Desktop Tool: system.run + 명령어 sanitization","Approval System: Lobster 승인 흐름","파일 위치: src/tools/"]}
{"type":"entity","name":"moonbot::Component::Sessions","entityType":"component","observations":["JSONL 형식 저장","저장 경로: ~/.clawdbot/agents/<agentId>/sessions/<sessionId>.jsonl","세션 공유 (sessions.send)","컴팩션 및 리플레이 기능","파일 위치: src/sessions/"]}
{"type":"entity","name":"moonbot::Component::Cron","entityType":"component","observations":["예약 작업 관리","cron.list, cron.edit, cron.run 명령","하트비트 및 이벤트 기반 발화","파일 위치: src/cron/"]}
{"type":"entity","name":"moonbot::Component::Auth","entityType":"component","observations":["사용자 페어링 승인","인증 토큰 관리","allowFrom 기반 접근 제어","파일 위치: src/auth/"]}
{"type":"entity","name":"moonbot::Component::CLI","entityType":"component","observations":["명령어: moonbot gateway status, logs, doctor, call, pairing","Gateway 직접 RPC 호출 지원","보안/권한 진단 기능","파일 위치: src/cli/"]}
{"type":"entity","name":"moonbot::Convention::ToolRegistration","entityType":"convention","observations":["toolkit.register({ id, schema, run }) 인터페이스","TypeBox 사용한 스키마 정의","requiresApproval 옵션으로 승인 필요 도구 지정","평탄화된 구조 권장"]}
{"type":"entity","name":"moonbot::Convention::Naming","entityType":"convention","observations":["컴포넌트 파일: PascalCase (예: BrowserTool.ts)","타입 정의: 인터페이스/타입 분리","CLI 명령: kebab-case (예: gateway status)"]}
{"type":"entity","name":"moonbot","entityType":"project","observations":["Local-first AI Agent System","Moltbot 프레임워크 기반","TypeScript (ESM), Node.js 22+","WebSocket JSON-RPC (포트 18789)","멀티 서피스 채널 (Discord 등)","CLI: moonbot","PRD: local_ai_agent_prd.md","Spec: agent_system_spec.md"]}
{"type":"relation","from":"moonbot::Component::Gateway","to":"moonbot::Component::Channels","relationType":"manages"}
{"type":"relation","from":"moonbot::Component::Gateway","to":"moonbot::Component::Agents","relationType":"orchestrates"}
{"type":"relation","from":"moonbot::Component::Agents","to":"moonbot::Component::Tools","relationType":"uses"}
{"type":"relation","from":"moonbot::Component::Gateway","to":"moonbot::Component::Sessions","relationType":"manages"}
{"type":"relation","from":"moonbot::Component::Gateway","to":"moonbot::Component::Auth","relationType":"uses"}
{"type":"relation","from":"moonbot::Component::Channels","to":"moonbot::Component::Auth","relationType":"uses"}
{"type":"relation","from":"moonbot::Component::CLI","to":"moonbot::Component::Gateway","relationType":"communicates"}